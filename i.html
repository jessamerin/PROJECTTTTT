<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ExchangeEase | Student Survival OS</title>
    
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        :root {
            --primary: #4f46e5;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --bg: #f8fafc;
        }

        body { font-family: 'Inter', system-ui, sans-serif; background: var(--bg); margin: 0; color: #1e293b; }

        /* --- UI Navigation --- */
        nav {
            background: white; padding: 1rem 5%; border-bottom: 1px solid #e2e8f0;
            display: flex; justify-content: space-between; align-items: center;
            position: sticky; top: 0; z-index: 1000;
        }
        .logo { font-weight: 800; font-size: 1.5rem; color: var(--primary); }

        /* --- Main Layout --- */
        .dashboard {
            display: grid; grid-template-columns: 320px 1fr 340px;
            gap: 20px; max-width: 1600px; margin: 20px auto; padding: 0 20px;
        }

        .card {
            background: white; border-radius: 16px; padding: 20px;
            box-shadow: 0 4px 6px -1px rgba(0,0,0,0.05); border: 1px solid #e2e8f0;
            margin-bottom: 20px;
        }

        /* --- Map Features --- */
        .map-container { height: 500px; border-radius: 16px; overflow: hidden; position: relative; border: 1px solid #e2e8f0; }
        #map { height: 100%; width: 100%; z-index: 1; }
        .map-search {
            position: absolute; top: 15px; left: 50%; transform: translateX(-50%);
            z-index: 1000; width: 90%; max-width: 450px; background: white;
            padding: 8px; border-radius: 50px; display: flex; box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }
        .map-search input { flex: 1; border: none; outline: none; padding: 0 15px; font-size: 0.9rem; }
        .map-search button { background: var(--primary); color: white; border: none; padding: 10px 20px; border-radius: 50px; cursor: pointer; }

        /* --- Functional Styling --- */
        .item-row { padding: 12px; background: #f1f5f9; border-radius: 10px; margin-bottom: 10px; font-size: 0.85rem; }
        .tag { font-size: 0.65rem; font-weight: 900; padding: 3px 8px; border-radius: 6px; text-transform: uppercase; display: inline-block; margin-bottom: 5px; }
        .tag-job { background: #e0e7ff; color: #3730a3; }
        .tag-stay { background: #dcfce7; color: #166534; }
        .tag-sos { background: #fee2e2; color: #991b1b; }

        .btn-full { width: 100%; padding: 12px; border: none; border-radius: 10px; background: var(--primary); color: white; font-weight: 700; cursor: pointer; margin-top: 5px; }

        @media (max-width: 1200px) { .dashboard { grid-template-columns: 1fr; } .hide-mobile { display: none; } }
    </style>
</head>
<body>

    <nav>
        <div class="logo">üåç ExchangeEase</div>
        <div style="display:flex; gap:15px; align-items:center;">
            <span id="locDisplay" style="font-weight:700; color:var(--primary); font-size:0.9rem;">üìç Current: Paris, FR</span>
            <button class="btn-full" style="background:var(--danger); width:auto; padding:8px 15px;" onclick="alert('Sending GPS to local responders...')">SOS</button>
        </div>
    </nav>

    <div class="dashboard">
        
        <aside class="hide-mobile">
            <div class="card">
                <h3><i class="fas fa-coins"></i> Money Tool</h3>
                <div class="item-row">
                    <small>Convert to Local</small>
                    <div style="display:flex; justify-content:space-between; margin-top:5px; align-items:center;">
                        <input type="number" id="usd" value="100" style="width:70px; border:1px solid #ddd; padding:5px; border-radius:5px;">
                        <span>USD ‚ûî <b>‚Ç¨92.45</b></span>
                    </div>
                </div>
                <p style="font-size:0.75rem; color:#64748b;">*Live Rate: 1 USD = 0.92 EUR</p>
            </div>

            <div class="card">
                <h3><i class="fas fa-file-invoice"></i> Visa & Admin</h3>
                <div class="item-row">
                    <strong>Registration Office</strong><br>
                    <small>Appointment wait: 14 days</small><br>
                    <button class="btn-full" style="background:#f1f5f9; color:var(--primary); font-size:0.7rem; padding:5px;">View Checklist</button>
                </div>
            </div>

            <div class="card">
                <h3 style="color:var(--danger);"><i class="fas fa-phone"></i> Emergency</h3>
                <div class="item-row" style="background:#fef2f2;">
                    <strong>Local Police: 112</strong><br>
                    <strong>Medical: 15</strong><br>
                    <strong>Campus Security: +33...</strong>
                </div>
            </div>
        </aside>

        <main>
            <div class="map-container">
                <div class="map-search">
                    <input type="text" id="cityInput" placeholder="Where are you moving?">
                    <button onclick="searchCity()">Go</button>
                </div>
                <div id="map"></div>
            </div>
            
            <div style="display:grid; grid-template-columns: 1fr 1fr; gap:15px; margin-top:20px;">
                <div class="card">
                    <h3><i class="fas fa-home"></i> Accommodation</h3>
                    <div id="housingList">
                        <div class="item-row">
                            <span class="tag tag-stay">Handover</span><br>
                            <b>Studio near Sorbonne</b><br>‚Ç¨750/mo. Available April.
                        </div>
                    </div>
                    <button class="btn-full" onclick="addItem('housingList', 'Stay')">+ Post Room</button>
                </div>
                <div class="card">
                    <h3><i class="fas fa-briefcase"></i> Student Jobs</h3>
                    <div id="jobList">
                        <div class="item-row">
                            <span class="tag tag-job">Part-Time</span><br>
                            <b>English Tutor</b><br>$25/hr ‚Ä¢ On-campus
                        </div>
                    </div>
                    <button class="btn-full" onclick="addItem('jobList', 'Job')">+ Post Vacancy</button>
                </div>
            </div>
        </main>

        <aside>
            <div class="card">
                <h3><i class="fas fa-bolt"></i> Exchange Hacks</h3>
                <div id="hackFeed">
                    <div class="item-row" style="border-left: 4px solid var(--warning);">
                        <strong>Cheap Groceries</strong><br>
                        "Avoid the center. Shop at 'Lidl' or 'Aldi' for 40% cheaper food."
                    </div>
                    <div class="item-row" style="border-left: 4px solid var(--primary);">
                        <strong>Sim Cards</strong><br>
                        "Get the 'Free Mobile' plan. It's ‚Ç¨20 for 250GB. No contract."
                    </div>
                </div>
                <button class="btn-full" onclick="addItem('hackFeed', 'Hack')">+ Share Tip</button>
            </div>

            <div class="card">
                <h3><i class="fas fa-user-friends"></i> Local Buddies</h3>
                <p style="font-size:0.8rem; color:#64748b;">Active students nearby:</p>
                <div style="display:flex; gap:10px; margin-top:10px;">
                    <div style="width:40px; height:40px; border-radius:50%; background:#ddd; display:flex; align-items:center; justify-content:center;">JD</div>
                    <div style="width:40px; height:40px; border-radius:50%; background:#ddd; display:flex; align-items:center; justify-content:center;">MK</div>
                    <div style="width:40px; height:40px; border-radius:50%; background:#ddd; display:flex; align-items:center; justify-content:center;">SL</div>
                </div>
            </div>
        </aside>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        // Init Map
        const map = L.map('map', { zoomControl: false }).setView([48.8566, 2.3522], 13);
        L.tileLayer('https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png').addTo(map);

        // Dummy Data for Map
        const points = [
            { name: "Student Housing A", pos: [48.8584, 2.2945], type: "Home" },
            { name: "Library (24/7)", pos: [48.8606, 2.3376], type: "Study" }
        ];

        points.forEach(p => {
            L.marker(p.pos).addTo(map).bindPopup(`<b>${p.name}</b><br>${p.type}`);
        });

        async function searchCity() {
            const city = document.getElementById('cityInput').value;
            if(!city) return;
            const res = await fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${city}`);
            const data = await res.json();
            if(data.length > 0) {
                map.flyTo([data[0].lat, data[0].lon], 13);
                document.getElementById('locDisplay').innerText = `üìç Current: ${city}`;
            }
        }

        function addItem(containerId, tagType) {
            const val = prompt(`Enter new ${tagType} title:`);
            if(val) {
                const div = document.createElement('div');
                div.className = 'item-row';
                div.innerHTML = `<span class="tag tag-${tagType.toLowerCase()}">${tagType}</span><br><b>${val}</b><br>Just posted by you.`;
                document.getElementById(containerId).prepend(div);
            }
        }

        window.onload = () => { setTimeout(() => { map.invalidateSize(); }, 500); };
    </script>
</body>
</html>