<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ExchangeEase | Survival Dashboard</title>

    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        :root {
            --primary: #4f46e5;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --bg: #f1f5f9;
            --glass: rgba(255, 255, 255, 0.9);
        }

        body {
            font-family: 'Plus Jakarta Sans', sans-serif;
            background: var(--bg);
            margin: 0;
            color: #1e293b;
            height: 100vh;
            overflow: hidden;
        }

        /* --- Global Layout --- */
        .app-shell {
            display: grid;
            grid-template-columns: 300px 1fr 360px;
            height: 100vh;
            gap: 18px;
            padding: 18px;
            box-sizing: border-box;
        }

        /* --- Sidebar Styling --- */
        .sidebar {
            background: white;
            border-radius: 20px;
            padding: 22px;
            overflow-y: auto;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.08);
        }

        .widget {
            background: #f8fafc;
            border-radius: 14px;
            padding: 14px;
            margin-bottom: 16px;
            border: 1px solid #e2e8f0;
        }

        .widget-title {
            font-size: 0.75rem;
            font-weight: 900;
            text-transform: uppercase;
            color: #64748b;
            margin-bottom: 12px;
            display: block;
            letter-spacing: 0.03em;
        }

        /* Currency Calc */
        .calc-row {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 8px;
        }

        .calc-row input {
            width: 100%;
            border: 1px solid #cbd5e1;
            padding: 10px;
            border-radius: 10px;
            outline: none;
            background: white;
        }

        /* Buttons */
        .sos-btn {
            background: var(--danger);
            color: white;
            border: none;
            width: 100%;
            padding: 14px;
            border-radius: 14px;
            font-weight: 900;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            box-shadow: 0 4px 14px rgba(239, 68, 68, 0.35);
            transition: 0.2s;
        }

        .sos-btn:active {
            transform: scale(0.97);
        }

        .action-btn {
            background: white;
            border: 1px solid #e2e8f0;
            width: 100%;
            padding: 12px;
            border-radius: 14px;
            font-weight: 900;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            transition: 0.2s;
        }

        .action-btn:hover {
            border-color: var(--primary);
            background: #f5f3ff;
        }

        /* --- Center: Map in a Box --- */
        .main-content {
            display: flex;
            flex-direction: column;
            gap: 14px;
        }

        .map-box {
            flex-grow: 1;
            background: white;
            border-radius: 24px;
            position: relative;
            overflow: hidden;
            box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.08);
            border: 4px solid white;
        }

        #map {
            height: 100%;
            width: 100%;
        }

        .map-search {
            position: absolute;
            top: 14px;
            left: 14px;
            right: 14px;
            z-index: 1000;
        }

        .map-search input {
            width: 100%;
            padding: 13px 16px;
            border-radius: 14px;
            border: 1px solid #e2e8f0;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.08);
            outline: none;
            font-size: 0.9rem;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
        }

        /* --- Feed Items --- */
        .feed-item {
            padding: 12px;
            border-radius: 14px;
            border: 1px solid #f1f5f9;
            margin-bottom: 12px;
            transition: 0.2s;
            background: #f8fafc;
        }

        .feed-item:hover {
            border-color: var(--primary);
            background: #f5f3ff;
        }

        .tag {
            font-size: 0.65rem;
            font-weight: 900;
            padding: 3px 8px;
            border-radius: 6px;
            text-transform: uppercase;
            margin-bottom: 6px;
            display: inline-block;
        }

        .tag-job { background: #e0e7ff; color: #3730a3; }
        .tag-guide { background: #dcfce7; color: #166534; }

        /* Places tags */
        .tag-food { background: #ffedd5; color: #9a3412; }
        .tag-housing { background: #fce7f3; color: #9d174d; }
        .tag-study { background: #e0f2fe; color: #075985; }
        .tag-parks { background: #dcfce7; color: #166534; }
        .tag-shops { background: #ede9fe; color: #5b21b6; }
        .tag-safety { background: #fee2e2; color: #991b1b; }

        .avatar-circle {
            width: 34px;
            height: 34px;
            border-radius: 50%;
            background: var(--primary);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            font-weight: 900;
        }

        /* Commute Tracker */
        .commute-card {
            border-left: 4px solid var(--primary);
            padding-left: 10px;
            margin-bottom: 10px;
        }

        /* Right Tabs */
        .tab-row {
            display: flex;
            gap: 10px;
            margin-top: 12px;
            margin-bottom: 14px;
        }

        .tab-btn {
            flex: 1;
            background: white;
            border: 1px solid #e2e8f0;
            padding: 10px 12px;
            border-radius: 14px;
            font-weight: 900;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            transition: 0.2s;
        }

        .tab-btn.active {
            background: #f5f3ff;
            border-color: var(--primary);
            color: #1e1b4b;
        }

        /* Filters */
        .filter-row {
            display: flex;
            gap: 10px;
            margin-bottom: 14px;
        }

        .filter-row input,
        .filter-row select {
            width: 100%;
            border: 1px solid #e2e8f0;
            padding: 10px 12px;
            border-radius: 14px;
            outline: none;
            background: white;
        }

        /* Mobile View */
        @media (max-width: 1100px) {
            body { overflow: auto; }
            .app-shell { grid-template-columns: 1fr; height: auto; }
            .sidebar { height: auto; }
            .map-box { height: 420px; }
        }
    </style>
</head>

<body>

<div class="app-shell">

    <!-- LEFT: SURVIVAL ESSENTIALS -->
    <aside class="sidebar utility-sidebar">
        <div style="margin-bottom: 18px;">
            <h2 style="color:var(--primary); font-weight: 1000; margin:0;">üåç ExchangeEase</h2>
            <p style="font-size:0.8rem; color:#64748b; margin-top:6px;" id="currentHubDisplay">Berlin Hub ‚Ä¢ V3.0</p>
        </div>

        <button class="sos-btn" onclick="triggerSOS()">
            <i class="fas fa-bullhorn"></i> SEND SOS ALERT
        </button>

        <div class="widget" style="margin-top:16px;">
            <span class="widget-title"><i class="fas fa-coins"></i> Currency Calc (<span id="localCurrencyCode">EUR</span>)</span>
            <div class="calc-row">
                <input type="number" id="usdAmount" value="100" oninput="convert()">
                <span style="font-weight:900;">USD</span>
            </div>
            <div class="calc-row">
                <input type="number" id="localAmount" readonly>
                <span id="targetCurrencyLabel" style="font-weight:900;">EUR</span>
            </div>
            <p style="font-size:0.7rem; color:#94a3b8; margin-top:10px;" id="rateText">*Live rate: 1 USD = 0.92 EUR</p>
        </div>

        <div class="widget">
            <span class="widget-title"><i class="fas fa-ambulance"></i> Emergency Services</span>
            <div style="font-size:0.9rem;" id="emergencyList">
                <div style="display:flex; justify-content:space-between; margin-bottom:8px;"><span>Police</span> <b class="num-police">110</b></div>
                <div style="display:flex; justify-content:space-between; margin-bottom:8px;"><span>Medical</span> <b class="num-med">112</b></div>
                <div style="display:flex; justify-content:space-between;"><span>Women SOS</span> <b class="num-campus">1091</b></div>
            </div>
        </div>

        <div class="widget">
            <span class="widget-title"><i class="fas fa-bus"></i> Live Commute</span>
            <div id="commuteList"></div>
        </div>
    </aside>

    <!-- CENTER: MAP BOX -->
    <main class="main-content">
        <div class="map-box">
            <div class="map-search">
                <input type="text" id="citySearch"
                       placeholder="Search a location (Delhi, Paris, London, Tokyo)..."
                       onkeydown="if(event.key==='Enter') searchLoc()">
            </div>
            <div id="map"></div>
        </div>

        <!-- Quick Status Bar -->
        <div style="display: flex; gap: 14px;">
            <div class="widget" style="flex: 1; margin: 0; display: flex; align-items: center; gap: 10px;">
                <i class="fas fa-cloud-sun" style="color: var(--warning)"></i>
                <span id="weatherText" style="font-weight:800;">Berlin: 12¬∞C, Overcast</span>
            </div>
            <div class="widget" style="flex: 1; margin: 0; display: flex; align-items: center; gap: 10px;">
                <i class="fas fa-signal" style="color: var(--success)"></i>
                <span style="font-weight:800;">Network: Stable (5G)</span>
            </div>
        </div>
    </main>

    <!-- RIGHT: CLEAN TABBED SIDEBAR -->
    <aside class="sidebar feed-sidebar">
        <h3 style="margin-top:0; margin-bottom:0;">Explore</h3>
        <p style="margin-top:6px; margin-bottom:0; color:#64748b; font-size:0.82rem;">
            Switch tabs to reduce clutter.
        </p>

        <!-- Tabs -->
        <div class="tab-row">
            <button class="tab-btn active" id="tabPlaces" onclick="switchTab('places')">
                <i class="fas fa-map"></i> Places
            </button>
            <button class="tab-btn" id="tabGuides" onclick="switchTab('guides')">
                <i class="fas fa-hands-helping"></i> Guides
            </button>
        </div>

        <!-- PLACES TAB -->
        <div id="placesTab">
            <span class="widget-title">City Navigation</span>

            <div class="filter-row">
                <select id="placeFilter" onchange="renderPlaces()">
                    <option value="all">All</option>
                    <option value="Food">Cheap Food</option>
                    <option value="Housing">Affordable Housing</option>
                    <option value="Study">Study Spots</option>
                    <option value="Parks">Parks</option>
                    <option value="Shops">Shops</option>
                    <option value="Safety">Safe Spots</option>
                </select>
                <input id="placeSearch" placeholder="Search places..." oninput="renderPlaces()" />
            </div>

            <div id="placeList"></div>

            <button class="action-btn" onclick="addPlace()">
                <i class="fas fa-location-dot"></i> + Add Place
            </button>
        </div>

        <!-- GUIDES TAB -->
        <div id="guidesTab" style="display:none;">
            <span class="widget-title">Local Guides</span>

            <div class="filter-row">
                <input id="guideSearch" placeholder="Search guides (visa, food, housing)..." oninput="renderGuides()" />
            </div>

            <div id="guideList"></div>

            <button class="action-btn" onclick="addGuide()">
                <i class="fas fa-user-plus"></i> + Add Guide
            </button>
        </div>

        <!-- SMALL GIGS -->
        <div style="margin-top:18px;">
            <span class="widget-title">Gigs</span>

            <div id="gigFeed">
                <div class="feed-item">
                    <span class="tag tag-job">Part-Time Job</span><br>
                    <strong>English Tutor Needed</strong>
                    <p style="font-size:0.8rem; color:#64748b; margin:6px 0 0;">
                        $20/hr at Campus Library. 2 hours/week.
                    </p>
                </div>
            </div>

            <button class="action-btn" onclick="addGig()">
                <i class="fas fa-briefcase"></i> + Post Gig
            </button>
        </div>
    </aside>

</div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<script>
    // =========================
    // HUB DATA (CITY SETTINGS)
    // =========================
    const locationData = {
        "berlin": {
            name: "Berlin Hub",
            currency: "EUR",
            rate: 0.92,
            police: "110",
            med: "112",
            womenSos: "030 19222",
            transit: ["U-Bahn U2 - 3 mins", "Bus 200 - 8 mins"],
            weather: "Berlin: 12¬∞C, Overcast"
        },
        "delhi": {
            name: "Delhi Hub",
            currency: "INR",
            rate: 83.15,
            police: "100",
            med: "102",
            womenSos: "1091",
            transit: ["Yellow Line (Metro) - 2 mins", "Auto Rickshaw - High Demand"],
            weather: "Delhi: 32¬∞C, Sunny"
        },
        "paris": {
            name: "Paris Hub",
            currency: "EUR",
            rate: 0.92,
            police: "17",
            med: "15",
            womenSos: "3919",
            transit: ["RER B - 2 mins", "Metro 4 - 5 mins"],
            weather: "Paris: 15¬∞C, Light Rain"
        },
        "london": {
            name: "London Hub",
            currency: "GBP",
            rate: 0.79,
            police: "999",
            med: "999",
            womenSos: "0808 2000 247",
            transit: ["Piccadilly Line - 1 min", "Bus 38 - 4 mins"],
            weather: "London: 10¬∞C, Foggy"
        }
    };

    // =========================
    // MAP INIT
    // =========================
    const map = L.map('map', { zoomControl: false }).setView([52.52, 13.40], 13);
    L.tileLayer('https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png').addTo(map);

    let currentRate = 0.92;
    let activeCity = "berlin";

    // =========================
    // PLACES + GUIDES DATA
    // =========================
    const cityPlaces = {
        berlin: [
            { id: 1, name: "Lidl (Budget Grocery)", type: "Food", coords: [52.5208, 13.4095], note: "Cheap groceries" },
            { id: 2, name: "TU Berlin Library", type: "Study", coords: [52.5126, 13.3269], note: "Quiet + WiFi" },
            { id: 3, name: "Tiergarten Park", type: "Parks", coords: [52.5146, 13.3501], note: "Relaxing walks" },
            { id: 4, name: "Affordable WG Rooms Area", type: "Housing", coords: [52.5000, 13.4200], note: "Shared housing zone" }
        ],
        delhi: [
            { id: 11, name: "Kamla Nagar Mess", type: "Food", coords: [28.6816, 77.2053], note: "‚Çπ50-‚Çπ80 meals" },
            { id: 12, name: "Delhi University Library", type: "Study", coords: [28.6872, 77.2147], note: "Study spot" },
            { id: 13, name: "Nehru Park", type: "Parks", coords: [28.5950, 77.1850], note: "Green area" },
            { id: 14, name: "PG Hub (North Campus)", type: "Housing", coords: [28.6890, 77.2120], note: "Affordable PGs" }
        ],
        paris: [
            { id: 21, name: "Lidl (Cheap Food)", type: "Food", coords: [48.8569, 2.3499], note: "Budget groceries" },
            { id: 22, name: "Biblioth√®que Sainte-Genevi√®ve", type: "Study", coords: [48.8467, 2.3459], note: "Top study spot" },
            { id: 23, name: "Luxembourg Gardens", type: "Parks", coords: [48.8462, 2.3372], note: "Park + chill" },
            { id: 24, name: "Student Housing Zone", type: "Housing", coords: [48.8584, 2.2945], note: "Affordable rooms" }
        ],
        london: [
            { id: 31, name: "Tesco Express Deals", type: "Food", coords: [51.5079, -0.1282], note: "Meal deals" },
            { id: 32, name: "British Library", type: "Study", coords: [51.5299, -0.1273], note: "Best quiet zone" },
            { id: 33, name: "Hyde Park", type: "Parks", coords: [51.5073, -0.1657], note: "Huge park" },
            { id: 34, name: "Zone 2 Shared Housing", type: "Housing", coords: [51.5150, -0.0750], note: "Cheaper rent" }
        ]
    };

    const cityGuides = {
        berlin: [
            { id: 101, name: "Lukas", year: "Year 3", specialty: "Visa & Banking", langs: "DE, EN", contact: "lukas.guide@example.com" },
            { id: 102, name: "Mina", year: "Year 2", specialty: "Student Housing", langs: "DE, EN", contact: "WhatsApp +49 151 234 567" }
        ],
        delhi: [
            { id: 111, name: "Aarav", year: "Year 4", specialty: "PG & Mess Locators", langs: "HI, EN", contact: "WhatsApp +91 98xxxxxx" },
            { id: 112, name: "Meera", year: "Year 2", specialty: "Metro + Safe Travel", langs: "HI, EN", contact: "meera.help@example.com" }
        ],
        paris: [
            { id: 121, name: "Sophie", year: "Year 3", specialty: "Housing Hacks", langs: "FR, EN", contact: "WhatsApp +33 6 12 34 56 78" },
            { id: 122, name: "Amine", year: "Year 1", specialty: "Cheap Food Spots", langs: "FR, EN, AR", contact: "amine.guide@example.com" }
        ],
        london: [
            { id: 131, name: "James", year: "Year 3", specialty: "Internship Guru", langs: "EN", contact: "james.help@example.com" },
            { id: 132, name: "Sara", year: "Year 2", specialty: "Budget Living", langs: "EN, ES", contact: "WhatsApp +44 7xxxxxxx" }
        ]
    };

    // Leaflet markers
    let placeMarkers = [];

    // =========================
    // DASHBOARD UPDATE
    // =========================
    function updateDashboard(cityKey) {
        const key = (cityKey || "berlin").toLowerCase();
        activeCity = locationData[key] ? key : "berlin";

        const data = locationData[activeCity];

        document.getElementById('currentHubDisplay').innerText = `${data.name} ‚Ä¢ V3.0`;
        document.getElementById('localCurrencyCode').innerText = data.currency;
        document.getElementById('targetCurrencyLabel').innerText = data.currency;
        document.getElementById('weatherText').innerText = data.weather;

        currentRate = data.rate;
        document.getElementById('rateText').innerText = `*Live rate: 1 USD = ${data.rate} ${data.currency}`;

        document.querySelector('.num-police').innerText = data.police;
        document.querySelector('.num-med').innerText = data.med;
        document.querySelector('.num-campus').innerText = data.womenSos;

        const transitCont = document.getElementById('commuteList');
        transitCont.innerHTML = data.transit.map(t => {
            const parts = t.split(' - ');
            return `
                <div class="commute-card">
                    <div style="font-size:0.9rem; font-weight:900;">${parts[0]}</div>
                    <div style="font-size:0.75rem; color:var(--success); font-weight:900;">${parts[1] || ""}</div>
                </div>
            `;
        }).join('');

        convert();
        renderPlaces();
        renderGuides();
    }

    // =========================
    // CURRENCY
    // =========================
    function convert() {
        const usd = parseFloat(document.getElementById('usdAmount').value || "0");
        document.getElementById('localAmount').value = (usd * currentRate).toFixed(2);
    }

    // =========================
    // SOS
    // =========================
    function triggerSOS() {
        const confirmSOS = confirm("TRIGGER EMERGENCY SOS? Your GPS coordinates will be sent to the local hub authorities.");
        if (confirmSOS) alert("Emergency Alert Sent! Local support is being notified.");
    }

    // =========================
    // SEARCH LOCATION
    // =========================
    async function searchLoc() {
        const val = document.getElementById('citySearch').value.trim();
        if (!val) return;

        const res = await fetch(`https://nominatim.openstreetmap.org/search?format=json&limit=1&q=${encodeURIComponent(val)}`);
        const data = await res.json();

        if (data.length > 0) {
            const lat = parseFloat(data[0].lat);
            const lon = parseFloat(data[0].lon);
            map.flyTo([lat, lon], 13);

            const lowerVal = val.toLowerCase();
            if (lowerVal.includes('delhi') || lowerVal.includes('india')) updateDashboard('delhi');
            else if (lowerVal.includes('paris')) updateDashboard('paris');
            else if (lowerVal.includes('london')) updateDashboard('london');
            else if (lowerVal.includes('berlin')) updateDashboard('berlin');
        }
    }

    // =========================
    // RIGHT SIDEBAR: TABS
    // =========================
    function switchTab(tab) {
        const placesTab = document.getElementById("placesTab");
        const guidesTab = document.getElementById("guidesTab");

        const tabPlaces = document.getElementById("tabPlaces");
        const tabGuides = document.getElementById("tabGuides");

        if (tab === "places") {
            placesTab.style.display = "block";
            guidesTab.style.display = "none";
            tabPlaces.classList.add("active");
            tabGuides.classList.remove("active");
        } else {
            placesTab.style.display = "none";
            guidesTab.style.display = "block";
            tabGuides.classList.add("active");
            tabPlaces.classList.remove("active");
        }
    }

    // =========================
    // PLACES (CITY NAVIGATION)
    // =========================
    function placeTagClass(type) {
        const t = (type || "").toLowerCase();
        if (t === "food") return "tag-food";
        if (t === "housing") return "tag-housing";
        if (t === "study") return "tag-study";
        if (t === "parks") return "tag-parks";
        if (t === "shops") return "tag-shops";
        if (t === "safety") return "tag-safety";
        return "";
    }

    function clearMarkers() {
        placeMarkers.forEach(m => map.removeLayer(m));
        placeMarkers = [];
    }

    function renderPlaces() {
        const list = document.getElementById("placeList");
        const filter = document.getElementById("placeFilter").value;
        const q = (document.getElementById("placeSearch").value || "").toLowerCase();

        list.innerHTML = "";
        clearMarkers();

        const places = cityPlaces[activeCity] || [];

        places
            .filter(p => filter === "all" || p.type === filter)
            .filter(p => (p.name + " " + p.note).toLowerCase().includes(q))
            .forEach(p => {
                const div = document.createElement("div");
                div.className = "feed-item";
                div.style.cursor = "pointer";

                div.innerHTML = `
                    <span class="tag ${placeTagClass(p.type)}">${p.type}</span><br>
                    <strong>${p.name}</strong>
                    <p style="font-size:0.8rem; color:#64748b; margin:6px 0 0;">${p.note}</p>
                `;

                div.onclick = () => {
                    map.flyTo(p.coords, 15);
                    const mk = placeMarkers.find(m => m._placeId === p.id);
                    if (mk) mk.openPopup();
                };

                list.appendChild(div);

                const marker = L.marker(p.coords).addTo(map)
                    .bindPopup(`<b>${p.name}</b><br>${p.type}<br><small>${p.note}</small>`);

                marker._placeId = p.id;
                placeMarkers.push(marker);
            });

        if (places.length === 0) {
            list.innerHTML = `<div class="feed-item"><strong>No places yet.</strong><p style="margin:6px 0 0; color:#64748b; font-size:0.8rem;">Add the first place for this city.</p></div>`;
        }
    }

    function addPlace() {
        const name = prompt("Place name:");
        if (!name) return;

        const type = prompt("Type (Food / Housing / Study / Parks / Shops / Safety):");
        if (!type) return;

        const note = prompt("Short note (price/details):");
        if (!note) return;

        const lat = prompt("Latitude:");
        const lon = prompt("Longitude:");
        if (!lat || !lon) return;

        const obj = {
            id: Date.now(),
            name: name.trim(),
            type: type.trim(),
            coords: [parseFloat(lat), parseFloat(lon)],
            note: note.trim()
        };

        if (!cityPlaces[activeCity]) cityPlaces[activeCity] = [];
        cityPlaces[activeCity].unshift(obj);

        renderPlaces();
    }

    // =========================
    // GUIDES
    // =========================
    function renderGuides() {
        const list = document.getElementById("guideList");
        const q = (document.getElementById("guideSearch").value || "").toLowerCase();

        list.innerHTML = "";

        const guides = cityGuides[activeCity] || [];

        guides
            .filter(g => (g.name + " " + g.specialty + " " + g.langs).toLowerCase().includes(q))
            .forEach(g => {
                const div = document.createElement("div");
                div.className = "feed-item";

                div.innerHTML = `
                    <span class="tag tag-guide">Guide</span><br>
                    <div style="display:flex; align-items:center; gap:10px; margin-top:6px;">
                        <div class="avatar-circle">${g.name[0]}</div>
                        <div>
                            <strong>${g.name} (${g.year})</strong><br>
                            <small style="color:#64748b;">Specialty: ${g.specialty}</small>
                        </div>
                    </div>
                    <p style="margin:10px 0 0; font-size:0.82rem; color:#334155;">
                        <b>Languages:</b> ${g.langs}<br>
                        <b>Contact:</b> ${g.contact}
                    </p>
                `;

                list.appendChild(div);
            });

        if (guides.length === 0) {
            list.innerHTML = `<div class="feed-item"><strong>No guides yet.</strong><p style="margin:6px 0 0; color:#64748b; font-size:0.8rem;">Be the first guide for this city.</p></div>`;
        }
    }

    function addGuide() {
        const name = prompt("Guide name:");
        if (!name) return;

        const year = prompt("Year (example: Year 2):");
        if (!year) return;

        const specialty = prompt("Specialty (visa, housing, food, transport):");
        if (!specialty) return;

        const langs = prompt("Languages (example: EN, FR):");
        if (!langs) return;

        const contact = prompt("Contact (WhatsApp / Email):");
        if (!contact) return;

        const obj = {
            id: Date.now(),
            name: name.trim(),
            year: year.trim(),
            specialty: specialty.trim(),
            langs: langs.trim(),
            contact: contact.trim()
        };

        if (!cityGuides[activeCity]) cityGuides[activeCity] = [];
        cityGuides[activeCity].unshift(obj);

        renderGuides();
    }

    // =========================
    // GIGS
    // =========================
    function addGig() {
        const title = prompt("Enter gig title:");
        if (!title) return;

        const pay = prompt("Pay / info (example: ‚Çπ500/day or ‚Ç¨12/hr):");
        if (!pay) return;

        const div = document.createElement('div');
        div.className = 'feed-item';
        div.innerHTML = `
            <span class="tag tag-job">New</span><br>
            <strong>${title}</strong>
            <p style="font-size:0.8rem; color:#64748b; margin:6px 0 0;">${pay}</p>
        `;

        document.getElementById('gigFeed').prepend(div);
    }

    // =========================
    // STARTUP
    // =========================
    window.onload = () => {
        updateDashboard('berlin');
        setTimeout(() => map.invalidateSize(), 400);
    };
</script>

</body>
</html>